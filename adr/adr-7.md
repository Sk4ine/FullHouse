# ADR-7: Система мониторинга и логирования

## Статус
**Принято**

## Контекст:
Для поддержки SLA 99.9% необходимо:
1. Отслеживание производительности критических операций:
   - Начисление бонусов
   - Покупки в маркетплейсе
2. Анализ инцидентов
3. Фильтрация данных по академическим группам

## Решение:
### Мониторинговый стек:
1. Сбор метрик: Prometheus
    - Поддержка высокочастотного сбора данных (5-секундный интервал)
    - Встроенная отказоустойчивость (local storage + S3 backup)
    - Гибкость в создании кастомных метрик
2. Визуализация: Grafana
    - Готовые дашборды для:
      - Реального времени: 95-й перцентиль времени ответа API
      - Академической аналитики: успеваемость по группам с фильтрами
    - Поддержка многопользовательского доступа с разными правами (админы/преподаватели)
3. Логирование: Loki
    - Эффективное хранение логов (до 10x сжатие)
    - Мгновенный поиск по тегам

## Последствия:
Плюсы:
- Возможность выявлять аномалии в реальном времени
- Гибкая аналитика по группам
- Открытый стек с богатой экосистемой

Минусы:
- Высокие требования к хранилищу логов
- Необходимость настройки правил алертинга

Митигация:
- Использование S3-хранилища для логов
- Шаблоны дашбордов для быстрого развертывания