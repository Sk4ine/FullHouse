# ADR-4: Базы данных

## Статус
**Принято**

## Контекст:
Разные домены требуют разных подходов к хранению данных:
- Транзакционные данные (бонусы)
- Гибкие данные (промо-акции)
- Аналитика

## Решение:
1. **PostgreSQL** для User, Task сервисов
2. **MongoDB** для Catalog сервиса
3. **PostgreSQL + TimescaleDB** для аналитики

Обоснование:
- **PostgreSQL** обеспечивает ACID для финансовых операций
- **MongoDB** подходит для динамических промо-акций
- **PostgreSQL + TimescaleDB** покрывает большую часть аналитики в проекте и позволяет снизить операционные затраты за счет единой БД с другими частями системы

## Последствия:
Плюсы:
- Оптимальное решение для каждого случая

Минусы:
- Необходимость поддержки двух СУБД
- Сложности в кросс-базовых запросах

## Альтернативы:
**Только SQL/NoSQL**:
- Транзакции: Для операций с бонусами критичен ACID (PostgreSQL).
- Гибкость: Промо-акции партнеров часто меняют структуру (MongoDB).

**Аналитика**:
- **MongoDB**: Неэффективен для сложных аналитических запросов с группировками.
- **Elasticsearch/ClickHouse**: Избыточны для потребностей проекта.
